<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Percentil de Press칚o Arterial Pedi치trica</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    select, input { padding: 5px; margin-top: 5px; width: 100%; box-sizing: border-box; }
    button { margin-top: 15px; padding: 8px 12px; width: 100%; }
    .resultado { margin-top: 20px; font-weight: bold; background: #f1f1f1; padding: 10px; border-radius: 5px; }
</style>
</head>
<body>

<h1>Calculadora de Percentil - PA Pedi치trica</h1>

<label>Sexo:
    <select id="sexo">
        <option value="M">Masculino</option>
        <option value="F">Feminino</option>
    </select>
</label>

<label>Idade (anos): <input type="number" id="idade" step="0.1" min="1" max="17"></label>
<label>Z da estatura (Zht): <input type="number" id="zht" step="0.01"></label>

<label>PA Sist칩lica (mmHg): <input type="number" id="pas" step="0.1" min="40" max="200"></label>
<label>PA Diast칩lica (mmHg): <input type="number" id="pad" step="0.1" min="20" max="150"></label>

<button onclick="calcularPercentis()">Calcular</button>

<div class="resultado" id="resultado"></div>

<script>
const coeficientes = {
    M: {
        SBP: { alpha: 102.19768, beta1: 1.82416, beta2: 0.12794, beta3: -0.00235, beta4: 0.00146, gamma1: 2.73157, gamma2: 0.21844, gamma3: -0.00135, gamma4: -0.01014, sigma: 10.7128 },
        DBP: { alpha: 61.10206,  beta1: 0.93801, beta2: 0.15915, beta3: -0.00412, beta4: 0.00092, gamma1: 1.15633, gamma2: 0.06492, gamma3: -0.00107, gamma4: -0.00218, sigma: 8.6741 }
    },
    F: {
        SBP: { alpha: 102.01027, beta1: 1.91542, beta2: 0.02135, beta3: 0.00096, beta4: 0.00105, gamma1: 2.77393, gamma2: 0.08445, gamma3: 0.00123, gamma4: -0.00944, sigma: 10.4855 },
        DBP: { alpha: 60.57968,  beta1: 1.07542, beta2: 0.07624, beta3: -0.00199, beta4: 0.00064, gamma1: 1.19016, gamma2: 0.04356, gamma3: -0.00012, gamma4: -0.00170, sigma: 8.4301 }
    }
};

// Fun칞칚o principal para calcular os dois percentis
function calcularPercentis() {
    const sexo = document.getElementById('sexo').value;
    const idade = parseFloat(document.getElementById('idade').value.replace(',', '.'));
    const zht = parseFloat(document.getElementById('zht').value.replace(',', '.'));
    const pas = parseFloat(document.getElementById('pas').value.replace(',', '.'));
    const pad = parseFloat(document.getElementById('pad').value.replace(',', '.'));

    if (isNaN(idade) || isNaN(zht) || isNaN(pas) || isNaN(pad)) {
        document.getElementById('resultado').innerHTML = '丘멆잺 Preencha todos os campos corretamente.';
        return;
    }

    // C치lculo para sist칩lica
    const resS = calcularPercentilUnico(sexo, "SBP", idade, zht, pas);
    // C치lculo para diast칩lica
    const resD = calcularPercentilUnico(sexo, "DBP", idade, zht, pad);

    document.getElementById('resultado').innerHTML = `
        游뽘 <strong>Sist칩lica (PAS):</strong><br>
        M칠dia: ${resS.media} mmHg<br>
        Z-score: ${resS.zscore}<br>
        Percentil: ${resS.percentil}%<br><br>
        游뽘 <strong>Diast칩lica (PAD):</strong><br>
        M칠dia: ${resD.media} mmHg<br>
        Z-score: ${resD.zscore}<br>
        Percentil: ${resD.percentil}%
    `;
}

function calcularPercentilUnico(sexo, tipo, idade, zht, pa) {
    const c = coeficientes[sexo][tipo];

    const media = c.alpha 
                + c.beta1 * idade 
                + c.beta2 * idade**2 
                + c.beta3 * idade**3 
                + c.beta4 * idade**4
                + zht * (c.gamma1 + c.gamma2 * idade + c.gamma3 * idade**2 + c.gamma4 * idade**3);

    const zscore = (pa - media) / c.sigma;
    const percentil = (0.5 * (1 + erf(zscore / Math.SQRT2))) * 100;

    return {
        media: media.toFixed(1).replace('.', ','),
        zscore: zscore.toFixed(2).replace('.', ','),
        percentil: percentil.toFixed(1).replace('.', ',')
    };
}

// Fun칞칚o erro para c치lculo do percentil
function erf(x) {
    const sign = (x >= 0) ? 1 : -1;
    x = Math.abs(x);
    const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429;
    const p = 0.3275911;
    const t = 1 / (1 + p * x);
    const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
    return sign * y;
}
</script>

</body>
</html>
